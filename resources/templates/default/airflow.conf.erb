[core]
executor = LocalExecutor
dags_folder = <%= @airflow_dir %>/dags
base_log_folder = <%= @data_dir %>/logs
pid_file = <%= @pid_file %>
load_examples = False
simple_auth_manager_all_admins = True
simple_auth_manager_passwords_file = <%= @airflow_env_dir %>/simple_auth_manager_passwords.json

[database]
sql_alchemy_conn = postgresql+psycopg2://<%= @db_user %>:<%= @airflow_password %>@<%= @database_host %>:<%= @db_port %>/<%= @db_name %>

[webserver]
base_url = http://<%= @ipsync %>:<%= @airflow_port %>
default_ui_timezone = UTC

[scheduler]
job_heartbeat_sec = 5
scheduler_heartbeat_sec = 5
min_file_process_interval = 30
catchup_by_default = False
max_active_runs_per_dag = 1

[api]
host = 0.0.0.0
port = <%= @airflow_port %>

[dag_processor]
refresh_interval = 60

[logging]
base_log_folder = <%= @data_dir %>/logs
remote_logging = False
task_log_reader = task
log_filename_template = {{ ti.dag_id }}/{{ ti.task_id }}/{{ ts }}/{{ try_number }}.log

[api_auth]
auth_backend = simple
jwt_secret = <%= @jwt_secret %>

[secrets]
<% if @airflow_secrets['backend'] %>
backend = <%= @airflow_secrets['backend'] %>
<% end %>

[cluster]
<% unless @airflow_web_hosts.empty? %>
nodes = <%= @airflow_web_hosts.join(",") %>
<% end %>
<% if @cluster_info %>
cluster_info = <%= @cluster_info.to_json %>
<% end %>
